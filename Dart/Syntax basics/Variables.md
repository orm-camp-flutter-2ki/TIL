# Variables 
[공식문서](https://dart.dev/language/variables)

### 기본 형태 : `[타입] [변수명] = [초기값];`
- 타입이 하나로 제한되지 않는 경우 `Object` or `Object?`를 쓸 것
  (`dynamic`은 최대한 지양할 것)
### 변수 타입에 `var`을 지정하여 타입 추론 가능
- 타입 추론을 컴파일러에게 맞기는 것으로 컴파일 타임에 타입이 정해진다.
- `dynamic`과는 다르다

### Top-level 변수와, static 변수는 기본적으로 지연 초기화된다.
변수를 사용하기 전까지, 초기화 코드가 실행되지 않는다.

<br/>

## Null safety
다트는 Null safety한 언어로 잘못된 null 접근을 컴파일 타임에 잡아주어, 런타임 에러를 방지해준다.
다트는 Null safety를 위해 3가지를 제안한다.

### 1. 변수 타입 뒤에 `?`를 붙여 nullable한 타입으로 만들 수 있다.

<br/>

### 2. 변수는 사용전에 반드시 초기화해야 한다.
- nullable한 타입은 초기화하지 않아도 null로 초기화되기에, 초기화를 생략해도 된다.
- non-nullable한 타입은 초기화 없이 접근시, 런타임 에러가 발생한다.
  => 단, 선언과 동시에 초기화할 필요는 없다. 변수 접근 이전에만 초기화하면 된다.
  ```dart
  void main() {
    String nonNull;
    String? nullable;

    print(nonNull); // Error: Non-nullable variable 'nonNull' must be assigned before it can be used.
    print(nullable); // null 출력
  }
  ```

<br/>

### 3. nullable한 타입을 갖는 표현식에 대해, 프로퍼티 및 메서드 호출이 불가능하다.
<br/>

## `late` 변수
### `late` 변경자를 통해 변수를 선언하는 경우
1. non-nullable한 변수를 선언 이후, 초기화 하고 싶은 경우
2. [지연 초기화](#지연-초기화란)를 하는 경우  

하지만 1, 2 모두 일반적인 non-nullable한 변수를 선언해서 사용해도 문제 없어 보인다.  
(초기화 이전에 non-nullable한 변수에 접근하는 경우 컴파일러가 에러를 표시해주었다)  
왜 굳이 `late` 변수를 사용해야 할까?

<br/>

### `late` 변수를 사용하는 이유
non-nullable한 변수를 선언만 하고 초기화를 하지 않고 접근하는 경우, 아래의 상황에서 컴파일러가 이를 정상적으로 감지 하지 못한다.
- top-level 선언
- instance 변수

즉, 초기화의 범위를 컴파일러가 단정할 수 없는 경우, 애러임에도 에러가 표시되지 않거나, 정상적으로 초기화하여도 에러가 표시될 수 있다.  

따라서, [위와 같은 경우](#late-변경자를-통해-변수를-선언하는-경우)에는 `late` 변경자를 쓰는 것이 더 바람직하다.

<br/>

### 지연 초기화란?
지연 초기화는 변수의 선언보다 초기화의 시점이 더 늦는 것을 뜻하며, 아래의 경우에서 유용하다.
1. 변수가 사용되지 않을 가능성이 큰 경우  
    => 굳이 미리 초기화할 필요가 없음

2. 초기화의 비용이 큰 경우  
    => 초기화를 최대한 미룰 수록 메모리 사용 및 병목현상을 최소화할 수 있음

3. instance 변수로 초기화되고 초기화 과정에서 `this`에 접근하는 경우  
    => 초기화에 필요한 참조가 변수 선언 시점에 아직 없음


<br/>

## Final and Const
`final`과 `const`는 모두 상수를 선언하는 키워드로 초기화 이 후, 값을 변경할 수 없다.

둘은 비슷해 보이지만 조금의 차이가 있다.

### `final`
- 초기화 시점: 런타임
- 변수의 값 초기화 이후, 변경 불가능 => 불변
- 소속된 객체마다 다른 인스턴스

### `const`
- 초기화 시점: 컴파일 타임
- 변수가 리터럴 그 자체 => 상수
- 항상 단일 값

또한, `const`의 경우 변수가 아닌 값에도 붙일 수 있고 값의 생성자에게 constant 값(단일 값)을 생성하도록 한다.  
```dart
void main() {
  var foo = const [];
  final bar = const [];
  print(foo.hashCode); // 1042999748
  print(bar.hashCode); // 1042999748
}
```
