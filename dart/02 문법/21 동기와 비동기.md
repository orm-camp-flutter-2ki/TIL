# 동기(Synchronous)와 비동기(Asynchronous)
![2](https://github.com/yujiyeong/TIL/assets/149862753/2f5a6b4b-0dab-40ed-877c-a6dbe4355d54)

- 비동기를 사용하면 `time taken`이 적어진다.
- 우리는 `async` - `await`을 사용할 것이다.
<br/>

## 동기(sync) 프로그래밍
- 코드가 순서대로 실행되며, 모든 작업은 이전 작업의 실행이 완료될 때까지 완료될 때까지 기다려야 하며 프로그램이 중단될 수 없다.
<br/>

## 비동기(async) 프로그래밍
- 현재 코드의 실행 결과를 받지 않고 이후 코드를 수행하는 기법이다.
- 컴퓨팅 자원을 효율적으로 사용하는 기법이지만 정확한 순서를 지켜 수행해야 하는지를 고려해야 한다.
- 임의의 순서로 또는 동시에 작업이 실행될 수 있다. 비동기를 처리하는 방법에는 `콜백`, `Future`, `async` - `await` 방식이 있다.
<br/>

## 📲 콜백 함수
- 비동기 코드를 순서대로 실행하는 가장 일반적인 방안으로 콜백(Callback)이 있다.
- 콜백은 실행 가능한 함수를 인자로 전달하여, 특정 상황이 발생할 때 호출되게 하는 방식이다.
> 언제 끝나는지 정확히는 알지 못할 때 사용하며, 끝나면 알림을 받는다.  
> 카페에서 커피☕를 주문하고 진동벨을 가지고 기다리면 커피가 준비되면 손님을 호출(Callback)하는 상황이다.  
<br/>

## Future
- Future는 비동기적으로 수행되는 작업의 결과를 나타내는 데 사용되는 리턴 타입이다.  
- (시간이 걸리는)미래에 완료되는 객체를 정의할 수 있다. 미래에 받아올 값을 의미한다.  
```dart
// 비동기적으로 수행되는 함수나 메서드의 반환 타입으로 사용
Future<String> name;
Future<int> number;
Future<Person> person;
```
<br/>

## Future 함수
- Future 함수는 함수 본문(`{}`) 앞에 `async` 키워드를 지정해 줘야 한다.
```dart
Future<void> main() async {}
```
- 대기하고 싶은 비동기 함수를 실행할 때 await 키워드를 사용해주면 코드를 작성한 순서대로 실행된다.
```dart
Future<String> futureData() {
  return Future.delayed(Duration(seconds: 2), () { // 2초 기다렸다가 '중간'을 출력
    return '중간';
  });
}

void main() async {
  print('시작');

  print(await futureData());
  
  print('끝');
}
```
```dart
// console

시작
중간 // 시작 출력 후 2초 대기했다가 출력된다.
끝
```
- await 키워드를 사용해 작성한 순서대로 실행시킨 결과이다. 만약 await 키워드를 사용하지 않았다면?
```dart
// console

시작 //(futureData()는 2초 대기 시작)
끝
중간 //(2초 대기 끝나면 출력)
```
<br/>

## Future then()
- future 함수끼리 연결을 하는 함수로, future 함수가 끝나고 나서 실행할 future 함수를 then()을 통해 계속 연결해 나가는 것이다.  
- 불필요한 인자는 언더바(`_`)를 쓰는 것이 관례이다.
<br/>

### then()의 문제점
- 확실히 콜백 보다는 편하지만 동기식 코드 보다는 결과 예측이 어렵다.  
- 단계가 많아지면 then()을 연결하는 체이닝 방식을 사용하는 것이 쉽지 않으며, 로직이 복잡해 지면 적절한 예외처리하기에 용이하지 않다.
- 잘 사용하지 않을 것이다.  
<br/>

### future 핸들링 기초와 future 에러 처리 (안중요)
- Future는 성공(then)일 수도 있고 오류(catchError)일 수도 있다.  
- `then()` : 비동기 작업이 성공한 경우 호출되는 콜백 함수를 등록하는 메서드이다. 성공 상태에서 비동기 작업의 결과를 처리하는 데 사용된다.     
- `catchError()` : 비동기 작업이 실패한 경우 호출되는 콜백 함수를 등록하는 메서드이다. 오류 상태에서 발생한 예외나 에러를 처리하는 데 사용된다.  
- `Future.error()` : 에러를 발생시킬 때 사용한다.    
- `throw Exception()` : 예외를 발생시킬 수 있다.
- `whenComplete()` : Future의 완료 여부와 상관없이 항상 호출되는 콜백 함수를 등록하는 데 사용한다.   
<br/>

## 병렬 처리 (Parallelism)
- 병렬 처리는 동시에 여러가지 일을 진행하는 것이다.  
- Future 함수는 await 없이 사용하면 동시에 여러개를 실행할 수 있다.  
> 예외, 우리와 관련 없이만 알아두면 좋다 : VS 동시성 (Concurrency) = 동시에 실행되는 것 같아 보임  
> 스레드, 프로세서와 함께 알아야 이해 가는 것 같다...   
> dart에는 스레드를 몰라도 된다.  
